<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- TODO: Fix the url -->
    <link rel="stylesheet" href="../main.css">
    <title>Spotifyer</title>
</head>

<body id="body">

    <h4>My top songs of the month</h4>
    <div id="main_body"></div>

    <!-- TODO: Share with friends -->
    <!-- <button class="share_button">Share with your friends!</button> -->

    <script>
        let path = window.location.pathname;
        let pathArray = path.split("/")
        pathArray.splice(0,2)

        console.log(pathArray)

        if(pathArray.length == 0){
            // No user id
            window.location.href = "/";
        } else {
            const userid = pathArray.join("");
            fetch("/api/songs/" + userid)
                .then(res => res.json())
                .then(data => {
                    data.items.forEach(d => {

                        const {
                            name,
                            artists,
                            external_urls: {
                                spotify: url
                            },
                            album: {
                                images: [bigImage]
                            }
                        } = d;
                        // console.log(name, artists, url, bigImage.url);

                        document.getElementById("main_body").innerHTML += `
        <div class="track">
            <a href="${url}">
                <img src=${bigImage.url} />
            </a>
        </div>
        `
                    })

                })
        }
    </script>
</body>

</html>